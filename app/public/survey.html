<!doctype html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
        integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

    <title>Friend Finder</title>
</head>

<body>
    <div class="container">
        <h2>Survey Questions</h2>
        <hr>
        <h3>
            <strong>About You</strong>
        </h3>
        <h4>Name (Required)</h4>
        <input type="text" class="form-control" id="name" required="" type="text">
        <h4>Link to Photo Image</h4>
        <input type="text" class="form-control" id="photo" required="" type="text">
        <hr>

        <!-- Question 1 -->
        <div class="form-group">
            <h3><strong>Question 1</strong></h3>
            <label for="question1">
                <h4>Identify closely with being the chosen one</h4>
            </label>
            <select class="form-control" id="question1">
                <option value="empty"></option>
                <option value="1">1 (Strongly Disagree)</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5 (Strongly Agree)</option>
            </select>
        </div>

        <!-- Question 2 -->
        <div class="form-group">
            <h3><strong>Question 2</strong></h3>
            <label for="question2">
                <h4>Enjoy martials art movies</h4>
            </label>
            <select class="form-control" id="question2">
                <option value="empty"></option>
                <option value="1">1 (Strongly Disagree)</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5 (Strongly Agree)</option>
            </select>
        </div>

        <!-- Question 3 -->
        <div class="form-group">
            <h3><strong>Question 3</strong></h3>
            <label for="question3">
                <h4>Love exploring haunted places</h4>
            </label>
            <select class="form-control" id="question3">
                <option value="empty"></option>
                <option value="1">1 (Strongly Disagree)</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5 (Strongly Agree)</option>
            </select>
        </div>

        <!-- Question 4 -->
        <div class="form-group">
            <h3><strong>Question 4</strong></h3>
            <label for="question4">
                <h4>Heavy into romance movies</h4>
            </label>
            <select class="form-control" id="question4">
                <option value="empty"></option>
                <option value="1">1 (Strongly Disagree)</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5 (Strongly Agree)</option>
            </select>
        </div>

        <!-- Question 5 -->
        <div class="form-group">
            <h3><strong>Question 5</strong></h3>
            <label for="question5">
                <h4>You are the brooding silent type</h4>
            </label>
            <select class="form-control" id="question5">
                <option value="empty"></option>
                <option value="1">1 (Strongly Disagree)</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5 (Strongly Agree)</option>
            </select>
        </div>

        <!-- Question 6 -->
        <div class="form-group">
            <h3><strong>Question 6</strong></h3>
            <label for="question6">
                <h4>A joker/ class clown of the group</h4>
            </label>
            <select class="form-control" id="question6">
                <option value="empty"></option>
                <option value="1">1 (Strongly Disagree)</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5 (Strongly Agree)</option>
            </select>
        </div>

        <!-- Question 7 -->
        <div class="form-group">
            <h3><strong>Question 7</strong></h3>
            <label for="question7">
                <h4>You enjoy syfy movies and fighting Space Monsters </h4>
            </label>
            <select class="form-control" id="question7">
                <option value="empty"></option>
                <option value="1">1 (Strongly Disagree)</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5 (Strongly Agree)</option>
            </select>
        </div>

        <!-- Question 8 -->
        <div class="form-group">
            <h3><strong>Question 8</strong></h3>
            <label for="question8">
                <h4>You're the superhero of your own story</h4>
            </label>
            <select class="form-control" id="question8">
                <option value="empty"></option>
                <option value="1">1 (Strongly Disagree)</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5 (Strongly Agree)</option>
            </select>
        </div>

        <!-- Question 9 -->
        <div class="form-group">
            <h3><strong>Question 9</strong></h3>
            <label for="question9">
                <h4>You're both the class clown and secret badass</h4>
            </label>
            <select class="form-control" id="question9">
                <option value="empty"></option>
                <option value="1">1 (Strongly Disagree)</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5 (Strongly Agree)</option>
            </select>
        </div>

        <!-- Question 10 -->
        <div class="form-group">
            <h3><strong>Question 10</strong></h3>
            <label for="question10">
                <h4>You're super dramatic</h4>
            </label>
            <select class="form-control" id="question10">
                <option value="empty"></option>
                <option value="1">1 (Strongly Disagree)</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5 (Strongly Agree)</option>
            </select>
        </div>

        <div class="text-center">
            <button id="submitBtn" type="submit" class="btn btn-success btn-lg">Submit</button>
        </div>


        <!-- Modal after survey -->
        <div id="bestfriend" class="modal fade" role="dialog">
            <div class="modal-dialog">
                <!-- modal content -->
                <div class="modal-content">
                    <div class="modal-header">
                        <h2 class="modal-title"><strong>Meet You New Friend</strong></h2>
                    </div>

                    <!-- modal body for match info -->
                    <div class="modal-body">
                        <h2 id="matchName"></h2>
                        <img src="" alt="Image Not Found" id="matchImg" style="max-width: 350px;">
                    </div>

                    <!-- modal footer -->
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal"> close</button>
                    </div>
                </div>
            </div>
        </div>
    </div>







    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
        integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
        integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
        integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
        crossorigin="anonymous"></script>

    <!-- Javascript for submission -->
    <script>
        var fullyCompleted;

        $(document).ready(function () {
            // event listener for submission
            $('#submitBtn').on('click', function () {

                isItCompleted(function () {

                    //proceed with AJAX call
                    if(fullyCompleted){
                        collectInputs();
                    }
                    else{
                        alert('Please complete all fields!!')
                    }
                }); //end isItComplete
            }); //end submit listener
        }); // document ready

        //validate user input
        function isItCompleted(callback){

            //Check through all the questions
            var questionsCompleted
            $('.form-control').each(function() {
                if( $(this).val === ""){
                    questionsCompleted = false;
                }
            })
            .promise().done(function(){

                // checks if any questions is incomplete
                if(questionsCompleted === false){
                    fullyCompleted = false;
                }
                
                // Determine if name is enter
                else if( $('#name').val().trim() === ""){
                    fullyCompleted = false;
                }

                // determine if image is enter
                else if( $('#photo').val().trim() === ""){
                    fullyCompleted = false;
                }
                else{
                    fullyCompleted = true;
                }

                callback();
            }); 
        }

        function collectInputs(){
            var newFriend = {
                name: $('#name').val().trim(),
                photo: $('#photo').val().trim(),
                score: []
            };

            // loop thru questions to get score
            var scoreArray = [];
            $('.form-control').each(function(){
                scoreArray.push(parseInt($(this).val));
            })
            .promise().done(function(){
                newFriend.score = scoreArray
                
                var currentUrl = window.location.origin;
                $.post(currentUrl + "/api/friends", newfriend, function(data){

                    $('#matchName').text(data.name);
                    $('#matchImg').attr('src', data.photo);

                    $('#bestfriend').modal('toggle')
                })
            })
        }

    </script>
</body>

</html>